{"conceptual":"\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"7\" sourceendlinenumber=\"7\">You write to a stream over HTTP using a <code>POST</code> request to the resource of the stream. If the stream does not exist then the stream is implicitly created.</p>\n<h2 id=\"event-store-media-types\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"9\" sourceendlinenumber=\"9\">Event Store media types</h2>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"11\" sourceendlinenumber=\"11\">Event Store supports a custom media type for posting events, <code>application/vnd.eventstore.events+json</code> or <code>application/vnd.eventstore.events+xml</code>. This format allows for extra functionality that posting events as <code>application/json</code> or <code>application/xml</code> does not. For example it allows you to post multiple events in a single batch.</p>\n<!-- TODO: And more? Why not use it? And why are these examples not using it? -->\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">The format represents data with the following jschema (<code>eventId</code> must be a UUID).</p>\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"17\" sourceendlinenumber=\"26\"><code class=\"lang-json\">[\n    {\n      &quot;eventId&quot;    : &quot;string&quot;,\n      &quot;eventType&quot;  : &quot;string&quot;,\n      &quot;data&quot;       : &quot;object&quot;,\n      &quot;metadata&quot;   : &quot;object&quot;\n    }\n]\n</code></pre><h2 id=\"writing-a-single-event\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"28\" sourceendlinenumber=\"28\">Writing a single event</h2>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"30\" sourceendlinenumber=\"30\">If you issue a <code>POST</code> request with data to a stream and the correct content type set it writes the event to the stream, and generates a <code>201</code> response from the server, giving you the location of the event. Using the following event, which <a href=\"~/code-examples/http-api/event.json\" data-raw-source=\"[you can also download as a file](~/code-examples/http-api/event.json)\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"30\" sourceendlinenumber=\"30\">you can also download as a file</a>:</p>\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"32\" sourceendlinenumber=\"32\"><code class=\"lang-json\" name=\"http-api-writing-single-event\">{\n  &quot;a&quot;: &quot;1&quot;\n}\n</code></pre><p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"34\" sourceendlinenumber=\"34\"><code>POST</code> the following request to create a stream and add an event to it:</p>\n<div class=\"tabGroup\" id=\"tabgroup_e5OAF5pzdi\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"36\" sourceendlinenumber=\"44\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"36\" sourceendlinenumber=\"36\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"40\" sourceendlinenumber=\"40\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_e5OAF5pzdi_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"38\" sourceendlinenumber=\"38\"><code class=\"lang-bash\" name=\"http-api-write-event-request\">curl -i -d &quot;@event.json&quot; &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/json&quot; -H &quot;ES-EventType: SomeEvent&quot; -H &quot;ES-EventId: C322E299-CB73-4B47-97C5-5054F920746E&quot;\n</code></pre></section>\n<section id=\"tabpanel_e5OAF5pzdi_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"42\" sourceendlinenumber=\"42\"><code class=\"lang-json\" name=\"http-api-write-event-response\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER\nAccess-Control-Allow-Origin: *\nLocation: http://127.0.0.1:2113/streams/newstream/0\nContent-Type: text/plain; charset: utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Fri, 28 Jun 2013 12:17:59 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"46\" sourceendlinenumber=\"46\">Some clients may not be able to generate a unique identifier (or may not want to) for the event ID. You need this ID for idempotence purposes and Event Store can generate it for you.</p>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"48\" sourceendlinenumber=\"48\">If you leave off the <code>ES-EventId</code> header you see different behavior:</p>\n<div class=\"tabGroup\" id=\"tabgroup_e5OAF5pzdi-1\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"50\" sourceendlinenumber=\"58\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-1_tabid-3\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-1_tabid-3\" data-tab=\"tabid-3\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"50\" sourceendlinenumber=\"50\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-1_tabid-4\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-1_tabid-4\" data-tab=\"tabid-4\" tabindex=\"-1\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"54\" sourceendlinenumber=\"54\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_e5OAF5pzdi-1_tabid-3\" role=\"tabpanel\" data-tab=\"tabid-3\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"52\" sourceendlinenumber=\"52\"><code class=\"lang-bash\" name=\"http-api-write-event-no-id-request\">curl -i -d &quot;@event.json&quot; &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/json&quot; -H &quot;ES-EventType: SomeEvent&quot;\n</code></pre></section>\n<section id=\"tabpanel_e5OAF5pzdi-1_tabid-4\" role=\"tabpanel\" data-tab=\"tabid-4\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"56\" sourceendlinenumber=\"56\"><code class=\"lang-json\" name=\"http-api-write-event-no-id-response\">HTTP/1.1 307 Temporary Redirect\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-Forwarded-Host, X-Forwarded-Prefix, X-PINGOTHER, Authorization, ES-LongPoll, ES-ExpectedVersion, ES-EventId, ES-EventType, ES-RequiresMaster, ES-HardDelete, ES-ResolveLinkTos\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position, ES-CurrentVersion\nLocation: http://127.0.0.1:2113/streams/newstream/incoming/8a00e469-3a99-4517-a0b0-8dc662ffad9b\nContent-Type: text/plain; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Tue, 24 Jul 2018 14:42:44 GMT\nContent-Length: 28\nKeep-Alive: timeout=15,max=100\n\nForwarding to idempotent URI%\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"60\" sourceendlinenumber=\"60\">In this case Event Store has responded with a <code>307 Temporary Redirect</code>. The location points to another URI that you can post the event to. This new URI is idempotent for posting, even without an event ID.</p>\n<div class=\"tabGroup\" id=\"tabgroup_e5OAF5pzdi-2\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"62\" sourceendlinenumber=\"70\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-2_tabid-5\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-2_tabid-5\" data-tab=\"tabid-5\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"62\" sourceendlinenumber=\"62\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-2_tabid-6\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-2_tabid-6\" data-tab=\"tabid-6\" tabindex=\"-1\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"66\" sourceendlinenumber=\"66\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_e5OAF5pzdi-2_tabid-5\" role=\"tabpanel\" data-tab=\"tabid-5\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"64\" sourceendlinenumber=\"64\"><code class=\"lang-bash\" name=\"http-api-write-event-follow-request\">curl -i -d &quot;@event.json&quot; &quot;http://127.0.0.1:2113/streams/newstream/incoming/8a00e469-3a99-4517-a0b0-8dc662ffad9b&quot; -H &quot;Content-Type: application/json&quot; -H &quot;ES-EventType: SomeEvent&quot;\n</code></pre></section>\n<section id=\"tabpanel_e5OAF5pzdi-2_tabid-6\" role=\"tabpanel\" data-tab=\"tabid-6\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"68\" sourceendlinenumber=\"68\"><code class=\"lang-json\" name=\"http-api-write-event-follow-response\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: GET, POST, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-Forwarded-Host, X-Forwarded-Prefix, X-PINGOTHER, Authorization, ES-LongPoll, ES-ExpectedVersion, ES-EventId, ES-EventType, ES-RequiresMaster, ES-HardDelete, ES-ResolveLinkTos\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position, ES-CurrentVersion\nLocation: http://127.0.0.1:2113/streams/newstream/0\nContent-Type: text/plain; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Tue, 24 Jul 2018 14:46:10 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"72\" sourceendlinenumber=\"72\">It&#39;s generally recommended to include an event ID if possible as it results in fewer round trips between the client and the server.</p>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"74\" sourceendlinenumber=\"74\">When posting to either the stream or to the returned redirect, clients must include the <code>EventType</code> header. If you forget to include the header you receive an error.</p>\n<div class=\"tabGroup\" id=\"tabgroup_e5OAF5pzdi-3\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"76\" sourceendlinenumber=\"84\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-3_tabid-7\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-3_tabid-7\" data-tab=\"tabid-7\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"76\" sourceendlinenumber=\"76\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-3_tabid-8\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-3_tabid-8\" data-tab=\"tabid-8\" tabindex=\"-1\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"80\" sourceendlinenumber=\"80\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_e5OAF5pzdi-3_tabid-7\" role=\"tabpanel\" data-tab=\"tabid-7\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"78\" sourceendlinenumber=\"78\"><code class=\"lang-bash\" name=\"http-api-write-event-no-type-request\">curl -i -d &quot;@event.json&quot; &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/json&quot;\n</code></pre></section>\n<section id=\"tabpanel_e5OAF5pzdi-3_tabid-8\" role=\"tabpanel\" data-tab=\"tabid-8\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"82\" sourceendlinenumber=\"82\"><code class=\"lang-json\" name=\"http-api-write-event-no-type-response\">HTTP/1.1 400 Must include an event type with the request either in body or as ES-EventType header.\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-Forwarded-Host, X-Forwarded-Prefix, X-PINGOTHER, Authorization, ES-LongPoll, ES-ExpectedVersion, ES-EventId, ES-EventType, ES-RequiresMaster, ES-HardDelete, ES-ResolveLinkTos\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position, ES-CurrentVersion\nContent-Type:\nServer: Mono-HTTPAPI/1.0\nDate: Tue, 24 Jul 2018 14:50:59 GMT\nContent-Length: 0\nConnection: close\n</code></pre></section>\n</div>\n<h2 id=\"batch-writes\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"86\" sourceendlinenumber=\"86\">Batch writes</h2>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"88\" sourceendlinenumber=\"88\">You can include more than one write in a single post by placing multiple events inside of the array representing the events, including metadata.</p>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"90\" sourceendlinenumber=\"90\">For example, the below has two events:</p>\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"92\" sourceendlinenumber=\"92\"><code class=\"lang-json\" name=\"http-api-multiple-events\">[\n    {\n        &quot;eventId&quot;: &quot;fbf4b1a1-b4a3-4dfe-a01f-ec52c34e16e4&quot;,\n        &quot;eventType&quot;: &quot;event-type&quot;,\n        &quot;data&quot;: {\n            &quot;a&quot;: &quot;1&quot;\n        }\n    },\n    {\n        &quot;eventId&quot;: &quot;0f9fad5b-d9cb-469f-a165-70867728951e&quot;,\n        &quot;eventType&quot;: &quot;event-type&quot;,\n        &quot;data&quot;: {\n            &quot;b&quot;: &quot;2&quot;\n        }\n    }\n]\n</code></pre><p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"94\" sourceendlinenumber=\"94\">When you write multiple events in a single post, Event Store treats them transactionally, it writes all events together or fails.</p>\n<div class=\"tabGroup\" id=\"tabgroup_e5OAF5pzdi-4\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"96\" sourceendlinenumber=\"104\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-4_tabid-17\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-4_tabid-17\" data-tab=\"tabid-17\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"96\" sourceendlinenumber=\"96\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-4_tabid-18\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-4_tabid-18\" data-tab=\"tabid-18\" tabindex=\"-1\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"100\" sourceendlinenumber=\"100\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_e5OAF5pzdi-4_tabid-17\" role=\"tabpanel\" data-tab=\"tabid-17\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"98\" sourceendlinenumber=\"98\"><code class=\"lang-bash\" name=\"http-api-write-multiple-events-request\">curl -i -d &quot;@multiple-events.json&quot; &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/vnd.eventstore.events+json&quot;\n</code></pre></section>\n<section id=\"tabpanel_e5OAF5pzdi-4_tabid-18\" role=\"tabpanel\" data-tab=\"tabid-18\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"102\" sourceendlinenumber=\"102\"><code class=\"lang-json\" name=\"http-api-write-multiple-events-response\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER\nAccess-Control-Allow-Origin: *\nLocation: http://127.0.0.1:2113/streams/newstream/1\nContent-Type: text/plain; charset: utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Fri, 28 Jun 2013 12:32:18 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<h3 id=\"appending-events\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"106\" sourceendlinenumber=\"106\">Appending events</h3>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"108\" sourceendlinenumber=\"108\">To append events, issue a <code>POST</code> request to the same resource again and edit the <code>eventId</code>:</p>\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"110\" sourceendlinenumber=\"110\"><code class=\"lang-json\" name=\"http-api-append-event\">[\n    {\n        &quot;eventId&quot;: &quot;fbf4a1a1-b4a3-4dfe-a01f-ec52c34e16e5&quot;,\n        &quot;eventType&quot;: &quot;event-type&quot;,\n        &quot;data&quot;: {\n            &quot;b&quot;: &quot;2&quot;\n        }\n    }\n]\n</code></pre><div class=\"tabGroup\" id=\"tabgroup_e5OAF5pzdi-5\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"112\" sourceendlinenumber=\"120\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-5_tabid-11\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-5_tabid-11\" data-tab=\"tabid-11\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"112\" sourceendlinenumber=\"112\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-5_tabid-12\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-5_tabid-12\" data-tab=\"tabid-12\" tabindex=\"-1\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"116\" sourceendlinenumber=\"116\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_e5OAF5pzdi-5_tabid-11\" role=\"tabpanel\" data-tab=\"tabid-11\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"114\" sourceendlinenumber=\"114\"><code class=\"lang-bash\" name=\"http-api-write-event-append-request\">curl -i -d &quot;@event-append.json&quot; &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/vnd.eventstore.events+json&quot;\n</code></pre></section>\n<section id=\"tabpanel_e5OAF5pzdi-5_tabid-12\" role=\"tabpanel\" data-tab=\"tabid-12\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"118\" sourceendlinenumber=\"118\"><code class=\"lang-json\" name=\"http-api-write-event-append-response\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER\nAccess-Control-Allow-Origin: *\nLocation: http://127.0.0.1:2113/streams/newstream/1\nContent-Type: text/plain; charset: utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Fri, 28 Jun 2013 12:32:18 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<h2 id=\"data-only-events\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"122\" sourceendlinenumber=\"122\">Data-only events</h2>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"124\" sourceendlinenumber=\"124\">Version 3.7.0 of Event Store added support for the <code>application/octet-stream</code> content type to support data-only binary events. When creating these events, you need to provide the <code>ES-EventType</code> and <code>ES-EventId</code> headers and cannot have metadata associated with the event. In the example below <code>SGVsbG8gV29ybGQ=</code> is the data you <code>POST</code> to the stream:</p>\n<div class=\"tabGroup\" id=\"tabgroup_e5OAF5pzdi-6\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"126\" sourceendlinenumber=\"134\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-6_tabid-13\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-6_tabid-13\" data-tab=\"tabid-13\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"126\" sourceendlinenumber=\"126\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-6_tabid-14\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-6_tabid-14\" data-tab=\"tabid-14\" tabindex=\"-1\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"130\" sourceendlinenumber=\"130\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_e5OAF5pzdi-6_tabid-13\" role=\"tabpanel\" data-tab=\"tabid-13\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"128\" sourceendlinenumber=\"128\"><code class=\"lang-bash\" name=\"http-api-write-event-data-request\">curl -i -d &quot;SGVsbG8gV29ybGQ=&quot; &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/octet-stream&quot; -H &quot;ES-EventType:rawDataType&quot; -H &quot;ES-EventId:eeccf3ce-4f54-409d-8870-b35dd836cca6&quot;\n</code></pre></section>\n<section id=\"tabpanel_e5OAF5pzdi-6_tabid-14\" role=\"tabpanel\" data-tab=\"tabid-14\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"132\" sourceendlinenumber=\"132\"><code class=\"lang-json\" name=\"http-api-write-event-data-response\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-Forwarded-Host, X-PINGOTHER, Authorization, ES-LongPoll, ES-ExpectedVersion, ES-EventId, ES-EventType, ES-RequiresMaster, ES-HardDelete, ES-ResolveLinkTo, ES-ExpectedVersion\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position\nLocation: http://127.0.0.1:2113/streams/newstream/0\nContent-Type: text/plain; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Mon, 27 Jun 2016 13:15:27 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<h2 id=\"expected-version-header\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"136\" sourceendlinenumber=\"136\">Expected version header</h2>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"138\" sourceendlinenumber=\"138\">The expected version header represents the version of the stream you expect.</p>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"140\" sourceendlinenumber=\"140\">For example if you write to a stream at version 1, then you expect it to be at version 1 next time you write. This can allow for optimistic locking when multiple applications are reading/writing to streams.</p>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"142\" sourceendlinenumber=\"142\">If your expected version is not the current version you receive an HTTP status code of 400.</p>\n<div class=\"WARNING\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"144\" sourceendlinenumber=\"144\"><h5>Warning</h5><p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"145\" sourceendlinenumber=\"145\">See the idempotency section below, if you post the same event twice it is idempotent and won&#39;t return a version error.</p>\n</div>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"147\" sourceendlinenumber=\"147\">First write an event to a stream, setting a version:</p>\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"149\" sourceendlinenumber=\"149\"><code class=\"lang-json\" name=\"http-api-append-event\">[\n    {\n        &quot;eventId&quot;: &quot;fbf4b1a1-b4a3-4dfe-a01f-ec52c34e16e4&quot;,\n        &quot;eventType&quot;: &quot;event-type&quot;,\n        &quot;data&quot;: {\n            &quot;a&quot;: &quot;1&quot;\n        }\n    }\n]\n</code></pre><p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"151\" sourceendlinenumber=\"151\"><a href=\"~/code-examples/http-api/event-version.json\" data-raw-source=\"[Download](~/code-examples/http-api/event-version.json)\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"151\" sourceendlinenumber=\"151\">Download</a></p>\n<div class=\"tabGroup\" id=\"tabgroup_e5OAF5pzdi-7\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"153\" sourceendlinenumber=\"161\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-7_tabid-15\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-7_tabid-15\" data-tab=\"tabid-15\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"153\" sourceendlinenumber=\"153\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-7_tabid-16\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-7_tabid-16\" data-tab=\"tabid-16\" tabindex=\"-1\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"157\" sourceendlinenumber=\"157\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_e5OAF5pzdi-7_tabid-15\" role=\"tabpanel\" data-tab=\"tabid-15\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"155\" sourceendlinenumber=\"155\"><code class=\"lang-bash\" name=\"http-api-write-event-version-request\">curl -i -d @event-version.json &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/vnd.eventstore.events+json&quot; -H &quot;ES-CurrentVersion: 0&quot;\n</code></pre></section>\n<section id=\"tabpanel_e5OAF5pzdi-7_tabid-16\" role=\"tabpanel\" data-tab=\"tabid-16\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"159\" sourceendlinenumber=\"159\"><code class=\"lang-json\" name=\"http-api-write-event-version-response\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-Forwarded-Host, X-Forwarded-Prefix, X-PINGOTHER, Authorization, ES-LongPoll, ES-ExpectedVersion, ES-EventId, ES-EventType, ES-RequiresMaster, ES-HardDelete, ES-ResolveLinkTos\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position, ES-CurrentVersion\nLocation: http://127.0.0.1:2113/streams/newstream/2\nContent-Type: text/plain; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Tue, 14 Aug 2018 10:02:08 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"163\" sourceendlinenumber=\"163\">If you now write to the stream with the incorrect version, you receive an HTTP status code 400 error.</p>\n<div class=\"tabGroup\" id=\"tabgroup_e5OAF5pzdi-8\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"165\" sourceendlinenumber=\"173\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-8_tabid-17\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-8_tabid-17\" data-tab=\"tabid-17\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"165\" sourceendlinenumber=\"165\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_e5OAF5pzdi-8_tabid-18\" role=\"tab\" aria-controls=\"tabpanel_e5OAF5pzdi-8_tabid-18\" data-tab=\"tabid-18\" tabindex=\"-1\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"169\" sourceendlinenumber=\"169\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_e5OAF5pzdi-8_tabid-17\" role=\"tabpanel\" data-tab=\"tabid-17\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"167\" sourceendlinenumber=\"167\"><code class=\"lang-bash\" name=\"http-api-write-event-wrong-version-request\">curl -i -d @event-version.json &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/vnd.eventstore.events+json&quot; -H &quot;ES-ExpectedVersion: 3&quot;\n</code></pre></section>\n<section id=\"tabpanel_e5OAF5pzdi-8_tabid-18\" role=\"tabpanel\" data-tab=\"tabid-18\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"171\" sourceendlinenumber=\"171\"><code class=\"lang-json\" name=\"http-api-write-event-wrong-version-response\">HTTP/1.1 400 Wrong expected EventNumber\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-Forwarded-Host, X-Forwarded-Prefix, X-PINGOTHER, Authorization, ES-LongPoll, ES-ExpectedVersion, ES-EventId, ES-EventType, ES-RequiresMaster, ES-HardDelete, ES-ResolveLinkTos\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position, ES-CurrentVersion\nES-CurrentVersion: 0\nContent-Type: text/plain; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Tue, 14 Aug 2018 14:08:44 GMT\nContent-Length: 0\nConnection: close\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"175\" sourceendlinenumber=\"175\">There are special values you can use in the expected version header:</p>\n<ul sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"177\" sourceendlinenumber=\"179\">\n<li sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"177\" sourceendlinenumber=\"177\"><code>-2</code> states that this write should never conflict and should <strong>always</strong> succeed.</li>\n<li sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"178\" sourceendlinenumber=\"178\"><code>-1</code> states that the stream should not exist at the time of the writing (this write creates it).</li>\n<li sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"179\" sourceendlinenumber=\"179\"><code>0</code> states that the stream should exist but should be empty.</li>\n</ul>\n<h2 id=\"idempotency\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"182\" sourceendlinenumber=\"182\">Idempotency</h2>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"184\" sourceendlinenumber=\"184\">Appends to streams are idempotent based upon the <code>EventId</code> assigned in your post. If you were to re-run the last command it returns the same value again.</p>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"186\" sourceendlinenumber=\"186\">This is important behaviour as it&#39;s how you implement error handling. If you receive a timeout, broken connection, no answer, etc from your HTTP <code>POST</code> then it&#39;s your responsibility to retry the post. You must also keep the same UUID that you assigned to the event in the first <code>POST</code>.</p>\n<p sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"188\" sourceendlinenumber=\"188\">If you are using the expected version parameter with your post, then Event Store is 100% idempotent. If you use <code>-2</code> as your expected version value, Event Store does its best to keep events idempotent but cannot assure that everything is fully idempotent and you end up in &#39;at-least-once&#39; messaging. <a href=\"~/http-api/optimistic-concurrency-and-idempotence.md\" data-raw-source=\"[Read this guide](~/http-api/optimistic-concurrency-and-idempotence.md)\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"188\" sourceendlinenumber=\"188\">Read this guide</a> for more details on idempotency.</p>\n","type":"Conceptual","source":{"remote":{"path":"http-api/creating-writing-a-stream.md","branch":"feature/stats-REST","repo":"git@github.com:EventStore/docs.geteventstore.com.git"},"startLine":0.0,"endLine":0.0,"isExternal":false},"path":"http-api/creating-writing-a-stream.md","documentation":{"remote":{"path":"http-api/creating-writing-a-stream.md","branch":"feature/stats-REST","repo":"git@github.com:EventStore/docs.geteventstore.com.git"},"startLine":0.0,"endLine":0.0,"isExternal":false},"_docfxVersion":"2.43.3.0","_disableBreadcrumb":true,"_enableSearch":true,"_gitContribute":{"branch":"master"},"_appFaviconPath":"assets/favicon.ico","_appTitle":"Event Store","_appFooter":"&copy; 2019 Event Store Limited","_disableNavbar":false,"_disableToc":true,"_systemKeys":["conceptual","type","source","path","documentation","title","rawTitle","wordCount"],"title":"Creating and writing to a stream","rawTitle":"<h1 id=\"creating-and-writing-to-a-stream\" sourcefile=\"http-api/creating-writing-a-stream.md\" sourcestartlinenumber=\"5\" sourceendlinenumber=\"5\">Creating and writing to a stream</h1>","outputFileName":"index.html","wordCount":1294.0,"_lang":"csharp","_tocPath":"toc.html","_navPath":"toc.html","_rel":"../../","_path":"http-api/creating-writing-a-stream/index.html","_key":"http-api/creating-writing-a-stream.md","_navRel":"../../toc.html","_tocRel":"../../toc.html","_navKey":"~/toc.yml","_tocKey":"~/toc.yml","__global":{"classesInSubtitle":"Classes","structsInSubtitle":"Structs","interfacesInSubtitle":"Interfaces","enumsInSubtitle":"Enums","delegatesInSubtitle":"Delegates","constructorsInSubtitle":"Constructors","fieldsInSubtitle":"Fields","propertiesInSubtitle":"Properties","methodsInSubtitle":"Methods","eventsInSubtitle":"Events","operatorsInSubtitle":"Operators","eiisInSubtitle":"Explicit Interface Implementations","functionsInSubtitle":"Functions","membersInSubtitle":"Members","improveThisDoc":"Improve this Doc","viewSource":"View Source","inheritance":"Inheritance","inheritedMembers":"Inherited Members","namespace":"Namespace","assembly":"Assembly","syntax":"Syntax","overrides":"Overrides","implements":"Implements","remarks":"Remarks","examples":"Examples","seealso":"See Also","declaration":"Declaration","parameters":"Parameters","typeParameters":"Type Parameters","type":"Type","name":"Name","description":"Description","returns":"Returns","fieldValue":"Field Value","propertyValue":"Property Value","eventType":"Event Type","exceptions":"Exceptions","condition":"Condition","extensionMethods":"Extension Methods","note":"<h5>Note</h5>","warning":"<h5>Warning</h5>","tip":"<h5>Tip</h5>","important":"<h5>Important</h5>","caution":"<h5>Caution</h5>","next":"<h5>Next Steps</h5>","_shared":{}},"docurl":"https://github.com/EventStore/docs.geteventstore.com/blob/master/http-api/creating-writing-a-stream.md/#L1"}